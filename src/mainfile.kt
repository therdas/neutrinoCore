import base.Base16
import base.Base8
import base.BaseN
import base.context.ReferenceTo

import hardware.*

import functions.*
val preCompiledExampleOne = arrayOf(Pair(0xF000, 0x3E),
        Pair(0xF001, 0x3E),
        Pair(0xF002, 0x07),
        Pair(0xF003, 0x06),
        Pair(0xF004, 0x05),
        Pair(0xF005, 0x80),
        Pair(0xF006, 0x4F),
        Pair(0xF007, 0x76))
val preCompiledExampleTwo = arrayOf(Pair(0xF000, 0x3A),
        Pair(0xF001, 0x00),
        Pair(0xF002, 0xF5),
        Pair(0xF003, 0x2A),
        Pair(0xF004, 0x00),
        Pair(0xF005, 0xF5),
        Pair(0xF006, 0xEB),
        Pair(0xF007, 0x21),
        Pair(0xF008, 0x01),
        Pair(0xF009, 0x00),
        Pair(0xF00A, 0x01),
        Pair(0xF00B, 0x03),
        Pair(0xF00C, 0x00),
        Pair(0xF00D, 0x3E),
        Pair(0xF00E, 0x01),
        Pair(0xF00F, 0x32),
        Pair(0xF010, 0x00),
        Pair(0xF011, 0xFF),
        Pair(0xF012, 0x7C),
        Pair(0xF013, 0xBA),
        Pair(0xF014, 0xC2),
        Pair(0xF015, 0x23),
        Pair(0xF016, 0xF0),
        Pair(0xF017, 0x7D),
        Pair(0xF018, 0xBB),
        Pair(0xF019, 0xC2),
        Pair(0xF01A, 0x23),
        Pair(0xF01B, 0xF0),
        Pair(0xF01C, 0x3A),
        Pair(0xF01D, 0x00),
        Pair(0xF01E, 0xFF),
        Pair(0xF01F, 0x32),
        Pair(0xF020, 0x50),
        Pair(0xF021, 0xF5),
        Pair(0xF022, 0x76),
        Pair(0xF023, 0x7C),
        Pair(0xF024, 0xBA),
        Pair(0xF025, 0xD2),
        Pair(0xF026, 0x37),
        Pair(0xF027, 0xF0),
        Pair(0xF028, 0x7D),
        Pair(0xF029, 0xBB),
        Pair(0xF02A, 0xD2),
        Pair(0xF02B, 0x37),
        Pair(0xF02C, 0xF0),
        Pair(0xF02D, 0x3A),
        Pair(0xF02E, 0x00),
        Pair(0xF02F, 0xFF),
        Pair(0xF030, 0x3C),
        Pair(0xF031, 0x09),
        Pair(0xF032, 0x03),
        Pair(0xF033, 0x03),
        Pair(0xF034, 0xC3),
        Pair(0xF035, 0x0F),
        Pair(0xF036, 0xF0),
        Pair(0xF037, 0x3A),
        Pair(0xF038, 0x00),
        Pair(0xF039, 0xFF),
        Pair(0xF03A, 0x3D),
        Pair(0xF03B, 0x32),
        Pair(0xF03C, 0x50),
        Pair(0xF03D, 0xF5),
        Pair(0xF03E, 0x76),
        Pair(0xF500, 0x40),
        Pair(0xF501, 0x00))

fun main(args: Array<String>) {
    val reg = RegisterFile()
    val mem = Memory()
    initFunctionsLibrary(reg, mem)

    mem.setArray(preCompiledExampleTwo)
    consumeFromMemory(BaseN(0xF000, 16), arrayOf(0x76, 0xCF))
    println("::" + mem.get(Base16(0xF550)).value)
}